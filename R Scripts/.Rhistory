library(caret)
library(tm)
library(MASS)
#======================================================================================================
dir  = "/home/max/Desktop/Identification of the class of English text among several classes/R Scripts/"
setwd(dir = dir)
load("../data/bbc_DataMatrix.RData")
bbc.data.matrix$content <-iconv(bbc.data.matrix$content,"WINDOWS-1252","UTF-8")
#-----------------------------------------------------------------------------------------------------
preProcess_TFIDF <- function(row.data, stopword.dir, BagOfWord , boolstemm ){
packages <- c('tm')
if (length(setdiff(packages, rownames(installed.packages()))) > 0) {
install.packages(setdiff(packages, rownames(installed.packages())))
}
library(tm)
row.data<-iconv(row.data,"WINDOWS-1252","UTF-8")
stopwordlist<- readLines(stopword.dir)
train_corpus<- Corpus(VectorSource(row.data))
train_corpus <-tm_map(train_corpus,content_transformer(tolower))
train_corpus<-tm_map(train_corpus,removeNumbers)
train_corpus<-tm_map(train_corpus,removeWords,stopwords("english"))
train_corpus<-tm_map(train_corpus,removeWords,stopwordlist)
train_corpus<- tm_map(train_corpus,removePunctuation)
train_corpus<-tm_map(train_corpus,stripWhitespace)
if(boolstemm){
train_corpus<-tm_map(train_corpus,stemDocument,language = "english")
}
DTM <-DocumentTermMatrix(train_corpus,
control = list(tolower = T ,
removeNumbers =T ,
removePunctuation = T ,
stopwords = T
, stripWhitespace = T ,
dictionary = BagOfWord,
weighting = weightTfIdf))
print("DTM DONE !!")
print(DTM)
return(DTM)
}
#----------------------------------------------------------------------------------------------------
train_dtm <-preProcess_TFIDF(row.data = bbc.data.matrix$content ,stopword.dir = "../data/stopword.txt",
BagOfWord = NULL , TRUE)
train_dtm <- removeSparseTerms(train_dtm,0.993)
BagOW <- findFreqTerms(train_dtm)
dim(train_dtm)
train_matrix <- as.matrix(train_dtm)
#train_matrix <- binary.weight(train_matrix)
train_data_model <- as.data.frame(train_matrix)
train_data_model <- data.frame(y=bbc.data.matrix$class , x = train_data_model)
#----------------------------------------------------------------------------------------------------
remove(bbc.data.matrix)
remove(train_dtm)
remove(train_matrix)
#----------------------------------------------------------------------------------------------------
save(train_data_model,BagOW,file = "../data/BestModel_data_matrix.RData")
#----------------------------------------------------------------------------------------------------
read.dir <-function(dir , pattern){
file.names <- dir(dir, pattern = pattern)
file.names = as.data.frame(file.names)
file.names$content = NA
colnames(file.names) = c("filename", "content" )
for(i in 1:length(file.names[,1])){
path <- paste0(dir,'/',file.names[i,1])
line <-  readLines(path)
# print(file.names[i,1])
file.names[i,2] <-paste(line, sep = "", collapse = "")
}
return(file.names)
}
#------------------------------------------------------------------------------------------------------
library(caret)
library(doParallel)
cl <- makePSOCKcluster(5)
registerDoParallel(cl)
timr <- Sys.time()
svm <- train(y~.,data = train_data_model,method = 'svmLinear3')
stopCluster(cl)
total_runtime <- difftime(Sys.time(), timr)
print(total_runtime)
#------------------------------------------------------------------------------------------------------
external_data <- read.dir("../data/external_data/",".TXT")
external_corpus <- Corpus(VectorSource(as.matrix(external_data$content)))
ex_dtm <-preProcess_TFIDF(row.data = external_data$content ,stopword.dir = "../data/stopword.txt",
BagOfWord = BagOW , TRUE )
dim(ex_dtm)
### test1 matrix form
ex_matrix <- as.matrix(ex_dtm)
ex_data_model <- as.data.frame(ex_matrix)
##test1_data_model
dim(ex_data_model)
ex_data_model <- data.frame(x=ex_data_model)
ex_pred = predict(svm,newdata = ex_data_model  )
for(i in 1:length(ex_corpus) ){
print( ex_corpus[[i]][["content"]] )
print(": ")
print(ex_pred[i])
print("----------------------------------------------------------------------------------------------")
}
#========================================================================================================
external_data <- read.dir("../data/external_data/",".TXT")
external_corpus <- Corpus(VectorSource(as.matrix(external_data$content)))
ex_dtm <-preProcess_TFIDF(row.data = external_data$content ,stopword.dir = "../data/stopword.txt",
BagOfWord = BagOW , TRUE )
dim(ex_dtm)
### test1 matrix form
ex_matrix <- as.matrix(ex_dtm)
ex_data_model <- as.data.frame(ex_matrix)
##test1_data_model
dim(ex_data_model)
ex_data_model <- data.frame(x=ex_data_model)
ex_pred = predict(svm,newdata = ex_data_model  )
for(i in 1:length(ex_corpus) ){
print( external_corpus_corpus[[i]][["content"]] )
print(": ")
print(ex_pred[i])
print("----------------------------------------------------------------------------------------------")
}
#========================================================================================================
for(i in 1:length(external_corpus) ){
print( external_corpus[[i]][["content"]] )
print(": ")
print(ex_pred[i])
print("----------------------------------------------------------------------------------------------")
}
#========================================================================================================
external_data <- read.dir("../data/external_data/",".TXT")
external_corpus <- Corpus(VectorSource(as.matrix(external_data$content)))
ex_dtm <-preProcess_TFIDF(row.data = external_data$content ,stopword.dir = "../data/stopword.txt",
BagOfWord = BagOW , TRUE )
dim(ex_dtm)
### test1 matrix form
ex_matrix <- as.matrix(ex_dtm)
ex_data_model <- as.data.frame(ex_matrix)
##test1_data_model
dim(ex_data_model)
ex_data_model <- data.frame(x=ex_data_model)
ex_pred = predict(svm,newdata = ex_data_model  )
for(i in 1:length(external_corpus) ){
print( external_corpus[[i]][["content"]] )
print(": ")
print(ex_pred[i])
print("----------------------------------------------------------------------------------------------")
}
#========================================================================================================
external_data <- read.dir("../data/external_data/",".TXT")
external_corpus <- Corpus(VectorSource(as.matrix(external_data$content)))
ex_dtm <-preProcess_TFIDF(row.data = external_data$content ,stopword.dir = "../data/stopword.txt",
BagOfWord = BagOW , TRUE )
dim(ex_dtm)
### test1 matrix form
ex_matrix <- as.matrix(ex_dtm)
ex_data_model <- as.data.frame(ex_matrix)
##test1_data_model
dim(ex_data_model)
ex_data_model <- data.frame(x=ex_data_model)
ex_pred = predict(svm,newdata = ex_data_model  )
for(i in 1:length(external_corpus) ){
print( external_corpus[[i]][["content"]] )
print(": ")
print(ex_pred[i])
print("----------------------------------------------------------------------------------------------")
}
#========================================================================================================
View(external_data)
--------------------------------------------------------------------------------------------------
external_data <- read.dir("../data/external_data/",".TXT")
external_corpus <- Corpus(VectorSource(as.matrix(external_data$content)))
ex_dtm <-preProcess_TFIDF(row.data = external_data$content ,stopword.dir = "../data/stopword.txt",
BagOfWord = BagOW , TRUE )
dim(ex_dtm)
### test1 matrix form
ex_matrix <- as.matrix(ex_dtm)
ex_data_model <- as.data.frame(ex_matrix)
##test1_data_model
dim(ex_data_model)
ex_data_model <- data.frame(x=ex_data_model)
ex_pred = predict(svm,newdata = ex_data_model  )
for(i in 1:length(external_corpus) ){
print( external_corpus[[i]][["content"]] )
print(": ")
print(ex_pred[i])
print("----------------------------------------------------------------------------------------------")
}
#========================================================================================================
View(external_data)
--------------------------------------------------------------------------------------------------
external_data <- read.dir("../data/external_data/",".TXT")
external_corpus <- Corpus(VectorSource(as.matrix(external_data$content)))
ex_dtm <-preProcess_TFIDF(row.data = external_data$content ,stopword.dir = "../data/stopword.txt",
BagOfWord = BagOW , TRUE )
dim(ex_dtm)
### test1 matrix form
ex_matrix <- as.matrix(ex_dtm)
ex_data_model <- as.data.frame(ex_matrix)
##test1_data_model
dim(ex_data_model)
ex_data_model <- data.frame(x=ex_data_model)
ex_pred = predict(svm,newdata = ex_data_model  )
for(i in 1:length(external_corpus) ){
print( external_corpus[[i]][["content"]] )
print(": ")
print(ex_pred[i])
print("----------------------------------------------------------------------------------------------")
}
#========================================================================================================
View(external_data)
--------------------------------------------------------------------------------------------------
external_data <- read.dir("../data/external_data/",".TXT")
external_corpus <- Corpus(VectorSource(as.matrix(external_data$content)))
ex_dtm <-preProcess_TFIDF(row.data = external_data$content ,stopword.dir = "../data/stopword.txt",
BagOfWord = BagOW , TRUE )
dim(ex_dtm)
### test1 matrix form
ex_matrix <- as.matrix(ex_dtm)
ex_data_model <- as.data.frame(ex_matrix)
##test1_data_model
dim(ex_data_model)
ex_data_model <- data.frame(x=ex_data_model)
ex_pred = predict(svm,newdata = ex_data_model  )
for(i in 1:length(external_corpus) ){
print( external_corpus[[i]][["content"]] )
print(": ")
print(ex_pred[i])
print("----------------------------------------------------------------------------------------------")
}
#========================================================================================================
--------------------------------------------------------------------------------------------------
external_data <- read.dir("../data/external_data/",".TXT")
external_corpus <- Corpus(VectorSource(as.matrix(external_data$content)))
ex_dtm <-preProcess_TFIDF(row.data = external_data$content ,stopword.dir = "../data/stopword.txt",
BagOfWord = BagOW , TRUE )
dim(ex_dtm)
### test1 matrix form
ex_matrix <- as.matrix(ex_dtm)
ex_data_model <- as.data.frame(ex_matrix)
##test1_data_model
dim(ex_data_model)
ex_data_model <- data.frame(x=ex_data_model)
ex_pred = predict(svm,newdata = ex_data_model  )
for(i in 1:length(external_corpus) ){
print( external_corpus[[i]][["content"]] )
print(": ")
print(ex_pred[i])
print("----------------------------------------------------------------------------------------------")
}
#========================================================================================================
View(external_data)
external_data <- read.dir("../data/external_data/",".TXT")
#------------------------------------------------------------------------------------------------------
external_data <- read.dir("../data/external_data/",".TXT")
external_corpus <- Corpus(VectorSource(as.matrix(external_data$content)))
ex_dtm <-preProcess_TFIDF(row.data = external_data$content ,stopword.dir = "../data/stopword.txt",
BagOfWord = BagOW , TRUE )
dim(ex_dtm)
### test1 matrix form
ex_matrix <- as.matrix(ex_dtm)
ex_data_model <- as.data.frame(ex_matrix)
##test1_data_model
dim(ex_data_model)
ex_data_model <- data.frame(x=ex_data_model)
ex_pred = predict(svm,newdata = ex_data_model  )
for(i in 1:length(external_corpus) ){
print( external_corpus[[i]][["content"]] )
print(": ")
print(ex_pred[i])
print("----------------------------------------------------------------------------------------------")
}
#========================================================================================================
#------------------------------------------------------------------------------------------------------
external_data <- read.dir("../data/external_data/",".TXT")
external_corpus <- Corpus(VectorSource(as.matrix(external_data$content)))
ex_dtm <-preProcess_TFIDF(row.data = external_data$content ,stopword.dir = "../data/stopword.txt",
BagOfWord = BagOW , TRUE )
dim(ex_dtm)
### test1 matrix form
ex_matrix <- as.matrix(ex_dtm)
ex_data_model <- as.data.frame(ex_matrix)
##test1_data_model
dim(ex_data_model)
ex_data_model <- data.frame(x=ex_data_model)
ex_pred = predict(svm,newdata = ex_data_model  )
for(i in 1:length(external_corpus) ){
print( external_corpus[[i]][["content"]] )
print(": ")
print(ex_pred[i])
print("----------------------------------------------------------------------------------------------")
}
#========================================================================================================
#------------------------------------------------------------------------------------------------------
external_data <- read.dir("../data/external_data/",".TXT")
external_corpus <- Corpus(VectorSource(as.matrix(external_data$content)))
ex_dtm <-preProcess_TFIDF(row.data = external_data$content ,stopword.dir = "../data/stopword.txt",
BagOfWord = BagOW , TRUE )
dim(ex_dtm)
### test1 matrix form
ex_matrix <- as.matrix(ex_dtm)
ex_data_model <- as.data.frame(ex_matrix)
##test1_data_model
dim(ex_data_model)
ex_data_model <- data.frame(x=ex_data_model)
ex_pred = predict(svm,newdata = ex_data_model  )
for(i in 1:length(external_corpus) ){
print( external_corpus[[i]][["content"]] )
print(": ")
print(ex_pred[i])
print("----------------------------------------------------------------------------------------------")
}
#========================================================================================================
#------------------------------------------------------------------------------------------------------
external_data <- read.dir("../data/external_data/",".TXT")
external_corpus <- Corpus(VectorSource(as.matrix(external_data$content)))
ex_dtm <-preProcess_TFIDF(row.data = external_data$content ,stopword.dir = "../data/stopword.txt",
BagOfWord = BagOW , TRUE )
dim(ex_dtm)
### test1 matrix form
ex_matrix <- as.matrix(ex_dtm)
ex_data_model <- as.data.frame(ex_matrix)
##test1_data_model
dim(ex_data_model)
ex_data_model <- data.frame(x=ex_data_model)
ex_pred = predict(svm,newdata = ex_data_model  )
for(i in 1:length(external_corpus) ){
print( external_corpus[[i]][["content"]] )
print(": ")
print(ex_pred[i])
print("----------------------------------------------------------------------------------------------")
}
#========================================================================================================
saveRDS(svm,file = "../data/best-model.rda")
save(train_data_model,BagOW,file = "../data/best-model_DataMatrix")
saveRDS(svm ,file = "../data/best-model.rda")
load(file = "../data/best-model.rda")
loadmodel(file = "../data/best-model.rda")
loadmodel(file = "../data/best-model.rda")
loadmodel(file = "../data/BestModel_data_matrix.RData")
load(file = "../data/BestModel_data_matrix.RData")
load(file = "../data/best-model.rda")
load("/home/max/Desktop/Identification of the class of English text among several classes/data/best-model.rda")
load("/home/max/Desktop/Identification of the class of English text among several classes/data/best-model.rda")
load(file = "/home/max/Desktop/model.rda")
load(file = "/home/max/Desktop/model.rda")
loadmodel(file = "/home/max/Desktop/model.rda",)
loadmodel(file =  "/home/max/Desktop/model.rda",)
loadmodel(file =  "/home/max/Desktop/model.rda")
readRDS(file =  "/home/max/Desktop/model.rda")
readRDS(file =  "/home/max/Desktop/model.rda")
svm<-readRDS(file =  "/home/max/Desktop/model.rda")
svm<-readRDS(file =  "../data/best-model.rda")
test<- readline(prompt = "../data/external_data/6.TXT")
ex_dtm<-preProcess(row.data = test ,stopword.dir = "stopword.txt",BagOfWord = BagOW , TRUE )
test <- as.data.frame(test)
View(test)
test<- readline(prompt = "../data/external_data/6.TXT")
test<- readline(prompt = "../data/external_data/6.TXT")
test<- readLines(prompt = "../data/external_data/6.TXT")
test<- readLines(prompt = "../data/external_data/6.TXT")
test<- readLines(prompt = "../data/external_data/6.TXT")
test<- readLines(prompt = "../data/external_data/6.TXT")
test<- readLines(prompt = "../data/external_data/6.TXT")
test<- readLines(prompt = "../data/external_data/6.TXT")
test<- readLines(prompt = "../data/external_data/6.TXT")
test<- readLines(prompt = "../data/external_data/6.TXT")
remove(test)
test <-(prompt = "../data/external_data/6.TXT")
test <-readline(prompt = "../data/external_data/6.TXT")
test <-readline(prompt = "../data/external_data/6.TXT")
test <-read.csv(prompt = "../data/external_data/6.TXT")
test <-read_document(prompt = "../data/external_data/6.TXT")
test <-readLines(prompt = "../data/external_data/6.TXT")
test <-readLines("../data/external_data/6.TXT")
ex_dtm<-preProcess(row.data = test ,stopword.dir = "stopword.txt",BagOfWord = BagOW , TRUE )
test <- as.data.frame(test)
View(test)
test <-readLine("../data/external_data/6.TXT")
test <-readLine("../data/external_data/6.TXT")
test <-readline("../data/external_data/6.TXT")
test <-readLines("../data/external_data/6.TXT")
test <- as.data.frame(x = test)
View(test)
ex_dtm<-preProcess(row.data = test ,stopword.dir = "../data/stopword.txt",BagOfWord = BagOW , TRUE )
ex_dtm<-preProcess(row.data = test$test ,stopword.dir = "../data/stopword.txt",BagOfWord = BagOW , TRUE )
test <- as.data.frame(x = test)
ex_dtm<-preProcess(row.data = test$test ,stopword.dir = "../data/stopword.txt",BagOfWord = BagOW , TRUE )
matre <- matrix(nrow = 1,ncol = 1)
test <-readLines("../data/external_data/6.TXT")
matre<-paste(test, sep = "", collapse = "")
matre <- matrix(nrow = 1,ncol = 1)
matre <- matrix(nrow = 1,ncol = 1)
matre<-paste(test, sep = "", collapse = "")
matre <- matrix(nrow = 1,ncol = 1)
matre$<-paste(test, sep = "", collapse = "")
matre[1]<-paste(test, sep = "", collapse = "")
View(matre)
ex_dtm<-preProcess(row.data = matre ,stopword.dir = "../data/stopword.txt",BagOfWord = BagOW , TRUE )
ex_dtm<-preProcess(row.data = matre[1] ,stopword.dir = "../data/stopword.txt",BagOfWord = BagOW , TRUE )
ex_dtm<-preProcess(row.data = matre ,stopword.dir = "../data/stopword.txt",BagOfWord = BagOW , TRUE )
matre <- as.data.frame(matre)
ex_dtm<-preProcess(row.data = matre ,stopword.dir = "../data/stopword.txt",BagOfWord = BagOW , TRUE )
preProcess <- function(row.data, stopword.dir, BagOfWord , boolstemm){
packages <- c('tm')
if (length(setdiff(packages, rownames(installed.packages()))) > 0) {
install.packages(setdiff(packages, rownames(installed.packages())))
}
library(tm)
row.data<-iconv(row.data,"WINDOWS-1252","UTF-8")
stopwordlist<- readLines(stopword.dir)
train_corpus<- Corpus(VectorSource(row.data))
train_corpus <-tm_map(train_corpus,tolower)
train_corpus<-tm_map(train_corpus,removeNumbers)
train_corpus<-tm_map(train_corpus,removeWords,stopwords("english"))
train_corpus<-tm_map(train_corpus,removeWords,stopwordlist)
train_corpus<- tm_map(train_corpus,removePunctuation)
train_corpus<-tm_map(train_corpus,stripWhitespace)
if(boolstemm){
train_corpus<-tm_map(train_corpus,stemDocument,language = "english")
}
DTM <-DocumentTermMatrix(train_corpus,
control = list(tolower = T ,
removeNumbers =T ,
removePunctuation = T ,
stopwords = T
, stripWhitespace = T ,dictionary = BagOfWord  ))
print("DTM DONE !!")
print(DTM)
return(DTM)
}
ex_dtm<-preProcess(row.data = matre ,stopword.dir = "../data/stopword.txt",BagOfWord = BagOW , TRUE )
test <-readLines("../data/external_data/6.TXT")
ex_dtm<-preProcess(row.data = test ,stopword.dir = "../data/stopword.txt",BagOfWord = BagOW , TRUE )
str(ex_dtm)
dim(ex_dtm)
ex_matrix <- as.matrix(ex_dtm)
ex_data_model <- as.data.frame(ex_matrix)
dim(ex_data_model)
ex_data_model <- data.frame(x=ex_data_model)
ex_pred = predict(svm,newdata = ex_data_model  )
ex_pred
View(ex_data_model)
matre <- matrix(nrow = 1,ncol = 1)
matre[1]<-paste(test, sep = "", collapse = "")
matre <- as.data.frame(matre)
ex_dtm<-preProcess(row.data = matre[1] ,stopword.dir = "../data/stopword.txt",BagOfWord = BagOW , TRUE )
str(ex_dtm)
dim(ex_dtm)
ex_matrix <- as.matrix(ex_dtm)
ex_data_model <- as.data.frame(ex_matrix)
dim(ex_data_model)
ex_data_model <- data.frame(x=ex_data_model)
ex_pred = predict(svm,newdata = ex_data_model  )
ex_matrix
ex_pred
View(matre)
ex_pred = predict(svm,newdata = ex_data_model  )
ex_pred
read.dir <-function(dir , pattern){
file.names <- dir(dir, pattern = pattern)
file.names = as.data.frame(file.names)
file.names$content = NA
colnames(file.names) = c("filename", "content" )
for(i in 1:length(file.names[,1])){
path <- paste0(dir,'/',file.names[i,1])
line <-  readLines(path)
# print(file.names[i,1])
file.names[i,2] <-paste(line, sep = "", collapse = "")
}
return(file.names)
}
exdata <- read.dir("/home/max/Desktop/ex/",".TXT")
exdata$content <- iconv(exdata$content,"WINDOWS-1252","UTF-8")
ex_dtm<-preProcess(row.data = exdata$content ,stopword.dir = "../data/stopword.txt",BagOfWord = BagOW , TRUE )
str(ex_dtm)
dim(ex_dtm)
ex_matrix <- as.matrix(ex_dtm)
ex_data_model <- as.data.frame(ex_matrix)
dim(ex_data_model)
ex_data_model <- data.frame(x=ex_data_model)
ex_pred = predict(svm,newdata = ex_data_model  )
for(i in 1:length(ex_corpus) ){
print( ex_corpus[[i]][["content"]] )
print(": ")
print( ex_pred[i])
}
ex_corpus <- Corpus(VectorSource(as.matrix(exdata$content)))
str(ex_dtm)
dim(ex_dtm)
ex_matrix <- as.matrix(ex_dtm)
ex_data_model <- as.data.frame(ex_matrix)
dim(ex_data_model)
ex_data_model <- data.frame(x=ex_data_model)
ex_pred = predict(svm,newdata = ex_data_model  )
for(i in 1:length(ex_corpus) ){
print( ex_corpus[[i]][["content"]] )
print(": ")
print( ex_pred[i])
}
exdata <- read.dir("/home/max/Desktop/ex/",".TXT")
exdata <- read.dir("/home/max/Desktop/test1/",".TXT")
exdata$content <- iconv(exdata$content,"WINDOWS-1252","UTF-8")
ex_corpus <- Corpus(VectorSource(as.matrix(exdata$content)))
ex_dtm<-preProcess(row.data = exdata$content ,stopword.dir = "../data/stopword.txt",BagOfWord = BagOW , TRUE )
str(ex_dtm)
dim(ex_dtm)
ex_matrix <- as.matrix(ex_dtm)
ex_data_model <- as.data.frame(ex_matrix)
dim(ex_data_model)
ex_data_model <- data.frame(x=ex_data_model)
ex_pred = predict(svm,newdata = ex_data_model  )
for(i in 1:length(ex_corpus) ){
print( ex_corpus[[i]][["content"]] )
print(": ")
print( ex_pred[i])
}
